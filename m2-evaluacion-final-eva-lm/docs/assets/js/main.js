"use strict";const btn=document.querySelector(".js-button"),searchInput=document.querySelector(".js-search");let favorites=[],series=[];function setLocalStorage(){localStorage.setItem("favorites",JSON.stringify(favorites))}function getLocalStorage(){const e=JSON.parse(localStorage.getItem("favorites"));null!==e&&(favorites=e,paintFavorites())}const getDataFromServer=()=>(series=[],fetch(`http://api.tvmaze.com/search/shows?q=${searchInput.value}`).then(e=>e.json()).then(e=>{formatData(e),paintShows(),listenShows(),paintFavorites()})),formatData=function(e){for(const t of e)null===t.show.image?series.push({name:t.show.name,image:"https://via.placeholder.com/210x295/ffffff/666666/?text=TV",id:t.show.id}):series.push({name:t.show.name,image:t.show.image.medium,id:t.show.id})},paintShows=function(){const e=document.querySelector(".js-ul");let t="";for(let e=0;e<series.length;e++)t+=`<li class="js-li" data-index="${e}">\n      ${series[e].name}\n      <img src="${series[e].image}">\n    </li>`;e.innerHTML=t,console.log(e)};function listenShows(){const e=document.querySelectorAll(".js-li");console.log(e);for(let t=0;t<series.length;t++)e[t].addEventListener("click",getClikedShows)}function getClikedShows(e){const t=parseInt(e.currentTarget.dataset.index);isFavoriteShow(t)?removeFavorite(t):addFavorite(t),setLocalStorage(),paintShows(),listenShows(),paintFavorites(),console.log(favorites)}const isFavoriteShow=function(e){const t=series[e];for(const e of favorites)if(e.id===t.id)return!0;return!1};function addFavorite(e){favorites.push(series[e]),paintFavorites()}function paintFavorites(){const e=document.querySelector(".js-favorite");let t="";for(let e=0;e<favorites.length;e++)t+=`<li class="item-favorite" data-index="${e}">\n  ${favorites[e].name}\n    <img src="${favorites[e].image}">\n  </li>`;e.innerHTML=t}const removeFavorite=function(e){const t=series[e];for(let e=0;e<favorites.length;e++)t.id===favorites[e].id&&favorites.splice(e,1)};function handleClick(e){const t=getClikedShows(e);isFavoriteShow(t)?removeFavorite(series):addFavorite(series),paintShows(),listenShows(),paintFavorites()}btn.addEventListener("click",getDataFromServer),getLocalStorage();